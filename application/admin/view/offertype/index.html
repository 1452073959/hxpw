{extend name="index_layout"/}
{block name="main"}
<style type="text/css">
/*分页样式*/
.pagination{text-align:center;margin-top:20px;margin-bottom: 20px;}
.pagination li{margin:0px 10px; border:1px solid #e6e6e6;padding: 3px 8px;display: inline-block;}
.pagination .active{background-color: #dd1a20;color: #fff;}
.pagination .disabled{color:#aaa;}
</style>
<div class="layui-card">
    <div class="layui-card-body">
        <div class="layui-form">
            <blockquote class="layui-elem-quote news_search">
                <div class="layui-inline">
                    <a class="layui-btn layui-btn-sm" href="{:url('Offertype/addroom')}">添加空间类型</a>
                    <a class="layui-btn layui-btn-sm" href="{:url('Offertype/addconditions')}">添加工种类型</a>
                </div>
            </blockquote>
			<small>温馨提示：如果删除工种，该工种下对应的空间类型会全部删除！</small>
            <table class="layui-table">
                <colgroup>
                    <col width="80">
                    <col width="80">
                    <col width="160">
                </colgroup>
                <thead>
                    <tr>
                        <th class="taleft">工种</th>
                        <th class="taleft">空间类型</th>
                    </tr>
                </thead>
                <tbody> 
                  {foreach name="data" item="vo"}
                    <tr>   
                      <td class="taleft" {empty name="$vo.son"}colspan="2"{else/}rowspan="{:count($vo.son) * 1 + 1}"{/empty}>
						  <span>{$vo.name}</span>
						  <a href="{:url('admin/offertype/edit',['id'=>$vo.id])}" class="edit layui-btn layui-btn-sm" data-id="{$vo.id}">编辑</a>
						  <a class="delete layui-btn layui-btn-sm layui-btn-danger" data-id="{$vo.id}">删除</a>
					  </td>     
                    </tr>   
					{notempty name="$vo.son"}
						{volist name="$vo.son" id="vos"}
							<tr>
								<td>
									<span>{$vos.name}</span>
									<a href="{:url('admin/offertype/edit',['id'=>$vos.id])}" class="edit layui-btn layui-btn-sm" data-id="{$vo.id}">编辑</a>
									<a class="delete layui-btn layui-btn-sm layui-btn-danger" data-id="{$vos.id}">删除</a>
								</td>
							</tr>
						{/volist}
					{/notempty}
                 {/foreach}
                </tbody>
            </table>
       
        </div>
    </div>
</div>
{/block}
{block name="script"}
<script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
<script type="text/javascript">
	$(document).ready(function(){
		//删除
		$('a.delete').click(function(){
			var id = $(this).attr('data-id');
			if(!confirm('确认删除？')){return false;}
			$.ajax({
				url:"{:url('admin/offertype/delete')}",
				method:'post',
				data:{id:id},
				success:function(result){
					// console.log(result);
					alert(result.msg);
					if(result.code==1){
						window.location.href = result.url;
					}
				}
			});
		});
		//修改
		// $('a.edit').click(function(){
		// 	var val = $(this).parent().find('span').html(),id = $(this).attr('data-id');
		// 	$(this).parent().find('span').html('<input class="editinput" type="text" value="'+val+'" data-id="'+id+'">')
		// });
		// $(document).on('change','click',function(){
		// 	var id = $(this).attr('data-id'),val = $(this).val();
		// 	$.ajax({
		// 		url:"{:url('admin/offertype/edit')}",
		// 		method:'post',
		// 		data:{id:id}
		// 	});
		// });
	});
</script>
{/block}