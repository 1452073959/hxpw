{extend name="index_layout"/}
{block name="main"}
<style type="text/css">
    .fenname{padding:10px;padding-right:8px;line-height:30px}
    #sougs{line-height:35px;background-color:#009688;color:#fff;padding:5px;border-radius:2px;cursor:pointer;}
</style>
<div class="layui-card">
    <div class="layui-card-header">添加</div>
    <div class="layui-card-body">
        <form class="layui-form form-horizontal" action="{:url('admin/Offerlist/user_edit')}" method="post">
            
            <div class="layui-form-item">
                <label class="layui-form-label">客户姓名 </label>
                <div class="layui-input-inline w300">
                    <input type="text" name="customer_name" autocomplete="off" required="" placeholder="" class="layui-input" value="{$data.customer_name|default=''}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">客户电话<i class="bred">*</i></label>
                <div class="layui-input-inline w300">
                    <input type="text" name="phone" autocomplete="off" lay-verify="required|phone|number" placeholder="" class="layui-input" value="{$data.phone|default=''}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">房屋面积</label>
                <div class="layui-input-inline w300">
                    <input type="text" name="area" autocomplete="off" lay-verify="required|number" class="layui-input" value="{$data.area|default=''}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">工程地址</label>
                <div class="layui-input-inline">
                    <select name="provinces" lay-filter="provinces" data-type=1 lay-verify="required" lay-search>
                        <option value="">请选择省份</option>
                        {foreach $provinces as $k=>$v } 
                            <option value="{$v.provinceid}-{$v.province}" {eq name="$data['provinceid']" value="$v['provinceid']"}selected{/eq}>{$v.province}</option>
                        {/foreach}
                    </select>
                </div>
                <div class="layui-input-inline">
                    <select name="cities" lay-filter="cities" lay-verify="required" data-type=2 lay-search>
                        <option value="">请选择城市</option>
                        {foreach $cities as $k=>$v } 
                            <option value="{$v.cityid}-{$v.city}" {eq name="$data['cityid']" value="$v['cityid']"}selected{/eq}>{$v.city}</option>
                        {/foreach}
                    </select>
                </div>
                <div class="layui-input-inline">
                    <select name="areas" lay-verify="required" class="">
                        <option value="">请选择县区</option>
                        {foreach $areas as $k=>$v } 
                            <option value="{$v.areaid}-{$v.area}" {eq name="$data['areaid']" value="$v['areaid']"}selected{/eq}>{$v.area}</option>
                        {/foreach}
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">详细地址</label>
                <div class="layui-input-inline w300">
                    <input type="text" name="address" lay-verify="required" value="<?php echo str_replace($address,'',$data['address']) ?>" autocomplete="off" placeholder="" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">商务经理</label>
                <div class="layui-input-inline w300">
                    <input type="text" name="manager_name" disabled autocomplete="off" placeholder="" class="layui-input" value="{$data.manager_name|default=''}">
                </div>
            </div>

            <div class="layui-form-item">
                <label class="layui-form-label">报价师</label>
                <div class="layui-input-inline w300">
                    <input type="text" name="quoter_name" disabled autocomplete="off" placeholder="" class="layui-input" value="{$data.quoter_name|default=''}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">设计师</label>
                <div class="layui-input-inline w300">
                    <input type="text" name="designer_name" disabled autocomplete="off" placeholder="" class="layui-input" value="{$data.designer_name|default=''}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">画图</label>
                <div class="layui-input-inline w300">
                    <input type="text" name="" disabled autocomplete="off" placeholder="" class="layui-input" value="{$personnel[$data['assistant_id']]['name']|default='其他'}">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">业务员</label>
                <div class="layui-input-inline w300">
                    <input type="text" name="" disabled autocomplete="off" placeholder="" class="layui-input" value="{$personnel[$data['sale_id']]['name']|default='其他'}">
                </div>
            </div>

            <div class="layui-form-item">
                <label class="layui-form-label">设计总监</label>
                <div class="layui-input-inline w300">
                    <input type="text" name="director_designer" value="{$data.director_designer|default=''}" autocomplete="off" placeholder="" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">木作设计师</label>
                <div class="layui-input-inline w300">
                    <input type="text" name="wood_designer" value="{$data.wood_designer|default=''}" autocomplete="off" placeholder="" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">家具设计师</label>
                <div class="layui-input-inline w300">
                    <input type="text" name="furniture_designer" value="{$data.furniture_designer|default=''}" autocomplete="off" placeholder="" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">软装设计师</label>
                <div class="layui-input-inline w300">
                    <input type="text" name="soft_designer" value="{$data.soft_designer|default=''}" autocomplete="off" placeholder="" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">水电设计师</label>
                <div class="layui-input-inline w300">
                    <input type="text" name="sd_designer" value="{$data.sd_designer|default=''}" autocomplete="off" placeholder="" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">助理设计师</label>
                <div class="layui-input-inline w300">
                    <input type="text" name="aid_designer" value="{$data.aid_designer|default=''}" autocomplete="off" placeholder="" class="layui-input">
                </div>
            </div>

            <div class="layui-form-item">
                <label class="layui-form-label">房屋类型</label>
                <div class="layui-input-block">
                    <input type="radio" name="room_type" value="平层" title="平层" {eq name="$data['room_type']" value="平层"}checked{/eq} >
                    <input type="radio" name="room_type" value="复式" title="复式" {eq name="$data['room_type']" value="复式"}checked{/eq}>
                    <input type="radio" name="room_type" value="别墅" title="别墅" {eq name="$data['room_type']" value="别墅"}checked{/eq}>
                    <input type="radio" name="room_type" value="公装" title="公装" {eq name="$data['room_type']" value="公装"}checked{/eq}>
                    <!-- <input type="radio" name="room_type" value="酒店" title="酒店" {eq name="$data['room_type']" value="酒店"}checked{/eq}> -->
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">单选项</label>
                <div class="layui-input-block">
                    <!-- layui-hide -->
                    <input type="radio" name="house_type" lay-filter="" value="1" title="新房" {eq name="$data['house_type']" value="1"}checked{/eq}>
                    <input type="radio" name="house_type" lay-filter="" value="2" title="旧房" {eq name="$data['house_type']" value="2"}checked{/eq}>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">客户状态</label>
                <div class="layui-input-block">
                    <!-- layui-hide -->
                    <input type="radio" name="is_new" disabled lay-filter="is_new" value="1" title="新客户" {eq name="$data['is_new']" value="1"}checked{/eq}>
                    <input type="radio" name="is_new" disabled lay-filter="is_new" value="9" title="旧客户" {eq name="$data['is_new']" value="9"}checked{/eq}>
                    <!-- <input type="text" class="layui-input layui-hide w100" style="display: inline;" name="oldtime" id="oldtime" placeholder="签单时间" > -->
                    
                </div>
            </div>

            <div class="layui-form-item">
                <div class="layui-input-block">
                    <input type="hidden" name="id" value="{:input('id')}">
                    <button class="layui-btn ajax-post" lay-submit="" lay-filter="*" target-form="form-horizontal">立即提交</button>
                    <a class="layui-btn layui-btn-normal" href="{:url('admin/Offerlist/userlist')}">返回</a>
                </div>
            </div>
        </form>
    </div>
</div>
{/block}
{block name="script"}
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script type="text/javascript">
    layui.use('form', function(){
        var form = layui.form;
        form.on('select(provinces)', function(data){
            var type = data.elem.getAttribute('data-type');
            var province_id = data.value.split('-')[0];
            $.post('/admin/quote/ajax_get_address',{type:type,id:province_id},function(res){
                if(res.code == 1){
                    var html = '';
                    var cityid = '';
                    $(res.data).each(function(k,v){
                        if(k == 0){
                            cityid = v.cityid;
                        }
                        html += '<option value="'+v.cityid+'-'+v.city+'">'+v.city+'</option>';
                    })
                    $('select[name="cities"]').html('');
                    $('select[name="cities"]').append(html);
                    $('select[name="areas"]').html('');

                    //选择区
                    $.post('/admin/quote/ajax_get_address',{type:2,id:cityid},function(res){
                        if(res.code == 1){
                            var html1 = '';
                            $(res.data).each(function(k,v){
                                html1 += '<option value="'+v.areaid+'-'+v.area+'">'+v.area+'</option>';
                            })
                            $('select[name="areas"]').append(html1);
                        }else{
                            $('select[name="areas"]').html('');
                        }
                        form.render();
                    })

                }else{
                    $('select[name="areas"]').html('');
                    $('select[name="cities"]').html('');
                    form.render();
                }
            })
        });
        form.on('select(cities)', function(data){
            var type = data.elem.getAttribute('data-type');
            var city_id = data.value.split('-')[0];
            $.post('/admin/quote/ajax_get_address',{type:type,id:city_id},function(res){
                if(res.code == 1){
                    var html = '';
                    $(res.data).each(function(k,v){
                        html += '<option value="'+v.areaid+'-'+v.area+'">'+v.area+'</option>';
                    })
                    $('select[name="areas"]').html('');
                    $('select[name="areas"]').append(html);
                    form.render();
                }else{
                    $('select[name="areas"]').html('');
                    form.render();
                }
            })
        });
    });
    
</script>
{/block}